{% section 'collection-header' %}
{% section 'collection-promotions' %}
<div class="np-filter-bar">
<div class="page-width filter-bar">
  <div id="filter-buttons">
    <button type="button" class="custom-button" id="hideBtn"><img alt="filter" src="https://cdn.shopify.com/s/files/1/0283/1338/7053/files/filter.png?v=1581435703"> <span>Show filter<span></button>
    {% if collection %}
    <a id="clearBtn" href="/collections/{{collection.handle}}">Clear all</a>
    {% endif %}
  </div>
</div>
</div>  
<div id="CollectionAjaxResult" class="collection-content">
  <div id="CollectionAjaxContent">
    <div class="page-width">    
      <div class="grid custom-container-grid">
        <div class="grid__item medium-up--one-fifth grid__item--sidebar">
          {% section 'collection-sidebar' %}
        </div>
        <div class="grid__item medium-up--four-fifths grid__item--content">
          <div class="collection-grid__wrapper">
            {% section 'collection-template-variant' %}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
(function pollFor() {
    if (window.jQuery !== undefined) {
      var $ = window.jQuery;
      var npInitLazyFlag = false;
      
      $(document).on('click', '#hideBtn', function() {
        var currentText = $('#hideBtn > span').text();
//         console.log(currentText);
        $('#hideBtn > span').text(currentText == "Hide filter" ? "Show filter" : "Hide filter");
        $('#CollectionAjaxContent > .page-width > .grid').toggleClass("custom-container-grid");
        $('#CollectionSection > .grid').toggleClass("custom-item-grid");
        $('#CollectionSection > .grid > div').toggleClass("medium-up--one-quarter");
        $('#filter-buttons').toggleClass('np-custom-fliter-active');
		
        if(npInitLazyFlag === false) {
          $('#CollectionSection .grid__item:not(.aos-animate)').slice(0, 5).addClass("aos-animate");
          npInitLazyFlag = true;
        }

      });

      $(window).resize(function() {
        if($(window).width() > 768 && $('#FilterDrawer.drawer--is-open').length > 0) {
          $('.np-collection-filter button.js-drawer-open-collection-filters').click();
        }
      });
      
      
    } else {
        setTimeout(pollFor, 25);
    }
})();
</script>
